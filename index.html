<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Union Arena Deck Builder</title>
<style>
body { font-family: sans-serif; margin: 20px; background: #f0f0f0; }
#filters { margin-bottom: 20px; }
select { margin-right: 10px; padding: 5px; }
#cardsContainer { display: flex; flex-wrap: wrap; gap: 10px; justify-content: flex-start; }
.card { width: 120px; cursor: pointer; border: 1px solid #ccc; padding: 5px; background: white; text-align: center; }
.card img { width: 100px; height: 140px; object-fit: cover; }
.deck { margin-top: 20px; display: flex; flex-wrap: wrap; gap: 10px; }
.deckCard { width: 80px; cursor: pointer; border: 1px solid #333; padding: 2px; background: #eee; text-align: center; }
.deckCard img { width: 60px; height: 84px; object-fit: cover; display: block; margin: 0 auto; }
#deckCard div { margin-top: 2px; }
#cardModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; flex-direction: column; }
#modalContent { background: white; padding: 20px; border-radius: 10px; text-align: center; position: relative; }
#modalContent img { max-width: 200px; max-height: 280px; object-fit: cover; display: block; margin: 0 auto 10px; }
#modalContent button { margin: 5px; padding: 5px 10px; cursor: pointer; }
#deckWarning { color: red; margin-top: 10px; font-weight: bold; }
#closeModalBtnX { position: absolute; top: 5px; right: 10px; cursor: pointer; font-weight: bold; font-size: 18px; background: none; border: none; }
</style>
</head>
<body>

<h1>Union Arena Deck Builder</h1>

<div id="filters">
  <select id="colorFilter">
    <option value="">All Colors</option>
    <option value="Blue">Blue</option>
    <option value="Green">Green</option>
    <option value="Yellow">Yellow</option>
    <option value="Purple">Purple</option>
    <option value="Red">Red</option>
  </select>

  <select id="ipFilter">
    <option value="">All IPs</option>
    <option value="Jujutsu Kaisen">Jujutsu Kaisen</option>
    <option value="Hunter x Hunter">Hunter x Hunter</option>
    <option value="One Punch Man">One Punch Man</option>
    <option value="Bleach">Bleach</option>
    <option value="Black Clover">Black Clover</option>
  </select>

  <select id="typeFilter">
    <option value="">All Types</option>
    <option value="Character">Character</option>
    <option value="Event">Event</option>
    <option value="Site">Site</option>
  </select>
</div>

<h2>Your Deck <span id="deckCount">0 / 50</span></h2>
<div id="deck" class="deck"></div>
<div id="deckWarning"></div>

<div id="cardsContainer"></div>

<div id="cardModal">
  <div id="modalContent">
    <button id="closeModalBtnX">×</button>
    <img id="modalImage" src="" alt="Card View">
    <div id="modalName"></div>
    <div id="modalInfo"></div>
    <button id="addDeckBtn">Add to Deck</button>
    <button id="removeDeckBtn">Remove from Deck</button>
  </div>
</div>

<script>
const cards = [
  { name: "Aoi Todo", color: "Blue", ip: "Jujutsu Kaisen", type: "Character", image: "Images/Aoi Todo.PNG" },
  { name: "Divergent Fist", color: "Blue", ip: "Jujutsu Kaisen", type: "Event", image: "Images/Divergent Fist.PNG" },
  { name: "Malevolent Shrine", color: "Blue", ip: "Jujutsu Kaisen", type: "Site", image: "Images/Malevolent Shrine.PNG" },
  { name: "Sukuna", color: "Blue", ip: "Jujutsu Kaisen", type: "Character", image: "Images/Sukuna.PNG" },
  { name: "Sukuna's Finger", color: "Blue", ip: "Jujutsu Kaisen", type: "Event", image: "Images/Sukuna's Finger.PNG" },

  { name: "Kurapika", color: "Green", ip: "Hunter x Hunter", type: "Character", image: "Images/Kurapika.PNG" },
  { name: "Kurapika 2", color: "Green", ip: "Hunter x Hunter", type: "Character", image: "Images/Kurapika 2.PNG" },
  { name: "Kiriko", color: "Green", ip: "Hunter x Hunter", type: "Character", image: "Images/Kiriko.PNG" },
  { name: "Wing", color: "Green", ip: "Hunter x Hunter", type: "Character", image: "Images/Wing.PNG" },

  { name: "Bomb", color: "Yellow", ip: "One Punch Man", type: "Character", image: "Images/Bomb.PNG" },
  { name: "Bomb 2", color: "Yellow", ip: "One Punch Man", type: "Character", image: "Images/Bomb 2.PNG" },
  { name: "King", color: "Yellow", ip: "One Punch Man", type: "Character", image: "Images/King.PNG" },
  { name: "King 2", color: "Yellow", ip: "One Punch Man", type: "Character", image: "Images/King 2.PNG" },
  { name: "Genos", color: "Yellow", ip: "One Punch Man", type: "Character", image: "Images/Genos.PNG" },

  { name: "Byakuya Kuchiki", color: "Purple", ip: "Bleach", type: "Character", image: "Images/Byakuya Kuchiki.PNG" },
  { name: "Byakuya Kuchiki 2", color: "Purple", ip: "Bleach", type: "Character", image: "Images/Byakuya Kuchiki 2.PNG" },
  { name: "Renji Abarai", color: "Purple", ip: "Bleach", type: "Character", image: "Images/Renji Abarai.PNG" },
  { name: "Renji Abarai 2", color: "Purple", ip: "Bleach", type: "Character", image: "Images/Renji Abarai 2.PNG" },
  { name: "Nel Tu", color: "Purple", ip: "Bleach", type: "Character", image: "Images/Nel Tu.PNG" },

  { name: "Grey", color: "Red", ip: "Black Clover", type: "Character", image: "Images/Grey.PNG" },
  { name: "Liebe", color: "Red", ip: "Black Clover", type: "Character", image: "Images/Liebe.PNG" },
  { name: "Loropechika", color: "Red", ip: "Black Clover", type: "Character", image: "Images/Loropechika.PNG" },
  { name: "Asta", color: "Red", ip: "Black Clover", type: "Character", image: "Images/Asta.PNG" },
  { name: "Gauche Adlai", color: "Red", ip: "Black Clover", type: "Character", image: "Images/Gauche Adlai.PNG" }
];

const cardsContainer = document.getElementById('cardsContainer');
const deckContainer = document.getElementById('deck');
const deckWarning = document.getElementById('deckWarning');
const deckCount = document.getElementById('deckCount');
const modal = document.getElementById('cardModal');
const modalImage = document.getElementById('modalImage');
const modalName = document.getElementById('modalName');
const modalInfo = document.getElementById('modalInfo');
const addDeckBtn = document.getElementById('addDeckBtn');
const removeDeckBtn = document.getElementById('removeDeckBtn');
const closeModalBtnX = document.getElementById('closeModalBtnX');

let deck = [];
let selectedCard = null;

function displayCards() {
  const colorFilter = document.getElementById('colorFilter').value;
  const ipFilter = document.getElementById('ipFilter').value;
  const typeFilter = document.getElementById('typeFilter').value;

  cardsContainer.innerHTML = '';
  const filteredCards = cards.filter(card => {
    return (!colorFilter || card.color === colorFilter) &&
           (!ipFilter || card.ip === ipFilter) &&
           (!typeFilter || card.type === typeFilter);
  });

  filteredCards.forEach(card => {
    const cardDiv = document.createElement('div');
    cardDiv.className = 'card';
    cardDiv.innerHTML = `<img src="${card.image}" alt="${card.name}"><div>${card.name}</div>`;
    cardDiv.addEventListener('click', () => {
      selectedCard = card;
      modalImage.src = card.image;
      modalName.textContent = card.name;
      modalInfo.textContent = `${card.type} | ${card.color} | ${card.ip}`;
      modal.style.display = 'flex';
      deckWarning.textContent = '';
    });
    cardsContainer.appendChild(cardDiv);
  });
}

function displayDeck() {
  deckContainer.innerHTML = '';

  const deckGroups = {};
  deck.forEach(card => {
    if(deckGroups[card.name]) {
      deckGroups[card.name].count += 1;
    } else {
      deckGroups[card.name] = { ...card, count: 1 };
    }
  });

  Object.values(deckGroups).forEach(card => {
    const deckDiv = document.createElement('div');
    deckDiv.className = 'deckCard';
    deckDiv.innerHTML = `<img src="${card.image}" alt="${card.name}"><div>${card.name}</div><div>×${card.count}</div>`;
    
    deckDiv.addEventListener('click', () => {
      selectedCard = card;
      modalImage.src = card.image;
      modalName.textContent = card.name;
      modalInfo.textContent = `${card.type} | ${card.color} | ${card.ip}`;
      modal.style.display = 'flex';
      deckWarning.textContent = '';
    });

    deckContainer.appendChild(deckDiv);
  });

  deckCount.textContent = `${deck.length} / 50`;
}

function countCardInDeck(card) {
  return deck.filter(c => c.name === card.name).length;
}

function isSameIP(card) {
  if(deck.length === 0) return true;
  return deck[0].ip === card.ip;
}

addDeckBtn.addEventListener('click', () => {
  if(deck.length >= 50){
    deckWarning.textContent = "Deck is full (50 cards max)";
    return;
  }
  if(countCardInDeck(selectedCard) >= 4){
    deckWarning.textContent = "You can only have 4 copies of a card";
    return;
  }
  if(!isSameIP(selectedCard)){
    deckWarning.textContent = "All cards must be from the same IP";
    return;
  }
  deck.push(selectedCard);
  displayDeck();
  deckWarning.textContent = '';
});

removeDeckBtn.addEventListener('click', () => {
  const index = deck.findIndex(c => c.name === selectedCard.name);
  if(index > -1) deck.splice(index, 1);
  displayDeck();
  modal.style.display = 'none';
});

closeModalBtnX.addEventListener('click', () => {
  modal.style.display = 'none';
});

document.getElementById('colorFilter').addEventListener('change', displayCards);
document.getElementById('ipFilter').addEventListener('change', displayCards);
document.getElementById('typeFilter').addEventListener('change', displayCards);

displayCards();
</script>

</body>
</html>